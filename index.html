<!-- Top navigation -->
<nav class="top-nav" aria-label="Main">
  <ul style="display:flex; gap:1rem; list-style:none; padding:12px; margin:0; background:rgba(26,20,35,0.05);">
    <li><button onclick="startFirstTime()" aria-label="Start">Gra</button></li>
    <li><button onclick="showPage('elevator')">Elevator Pitch</button></li>
    <li><button onclick="showPage('about')">O nas</button></li>
    <li><button onclick="showPage('why')">Dlaczego my?</button></li>
    <li><button onclick="showPage('events')">Lista Wydarzeń</button></li>
  </ul>
</nav>

<!-- Sections -->
<div id="game" class="page">
  <h1>Rozpocznij grę</h1>
  <p>Wybierz pytania. Zagraj, żeby lepiej wejść w kontakt.</p>
  <div id="question-box">
    <div id="current-question" style="margin:1em 0; font-weight:600;"></div>
    <button id="next-question-btn">Następne pytanie</button>
    <div style="margin-top:8px;">
      <button onclick="skipToEvents()">Zobacz wydarzenia</button>
    </div>
  </div>
</div>

<div id="elevator" class="page" style="display:none;">
  <h2>Kim jesteśmy</h2>
  <p>Krótki elevator pitch: łączymy ludzi przez sensowne spotkania, przełamujemy samotność i budujemy relacje.</p>
  <button onclick="showPage('about')">Dalej: O nas</button>
</div>

<div id="about" class="page" style="display:none;">
  <h2>O nas</h2>
  <p>Opis misji, wartości, sposób działania.</p>
  <button onclick="showPage('why')">Dalej: Dlaczego my?</button>
</div>

<div id="why" class="page" style="display:none;">
  <h2>Dlaczego my?</h2>
  <p>Co nas wyróżnia, korzyści dla uczestnika, zaufanie.</p>
  <button onclick="showPage('events')">Zobacz wydarzenia</button>
</div>

<div id="events" class="page" style="display:none;">
  <h2>Lista wydarzeń</h2>
  <p><strong>Elevator pitch:</strong> Łączymy cię z ludźmi poprzez strukturalne rozmowy i autentyczne doświadczenia.</p>
  <ul id="event-list">
    <!-- Example events -->
    <li>
      <div>Wydarzenie 1 – 12 sierpnia</div>
      <button onclick="openSignup('Wydarzenie 1')">Zapisz się</button>
    </li>
    <li>
      <div>Wydarzenie 2 – 19 sierpnia</div>
      <button onclick="openSignup('Wydarzenie 2')">Zapisz się</button>
    </li>
  </ul>
  <div style="margin-top:1em;">
    <button onclick="showPage('collectEmail')">Zostaw email</button>
  </div>
</div>

<!-- Leave email with RODO -->
<div id="collectEmail" class="page" style="display:none;">
  <h2>Zostaw email</h2>
  <form id="emailForm">
    <label>
      Email:
      <input type="email" required name="email" placeholder="twoj@adres.pl" />
    </label>
    <div>
      <label>
        <input type="checkbox" required name="consent" />
        Zgadzam się na przetwarzanie danych zgodnie z RODO.
      </label>
    </div>
    <button type="submit">Wyślij</button>
    <button type="button" onclick="showPage('events')">Wróć do wydarzeń</button>
  </form>
  <div id="email-thanks" style="display:none;">Dzięki! Będziemy w kontakcie.</div>
</div>

<!-- Event signup -->
<div id="signup" class="page" style="display:none;">
  <h2 id="signup-title">Zapisz się na wydarzenie</h2>
  <form id="signupForm">
    <label>
      Email:
      <input type="email" required name="email" placeholder="twoj@adres.pl" />
    </label>
    <label>
      Telefon:
      <input type="tel" required name="phone" placeholder="+48 600 000 000" />
    </label>
    <div>
      <label>
        <input type="checkbox" required name="consent" />
        Zgadzam się na przetwarzanie danych zgodnie z RODO.
      </label>
    </div>
    <button type="submit">Zapisz się</button>
    <button type="button" onclick="showPage('events')">Wróć</button>
  </form>
  <div id="signup-thanks" style="display:none;">Super, zapisane.</div>
</div>

<script>
  // Navigation/showing
  const pages = ['game','elevator','about','why','events','collectEmail','signup'];
  function showPage(id) {
    pages.forEach(p => {
      document.getElementById(p).style.display = (p === id) ? 'block' : 'none';
    });
    // if coming to events from other path, nothing else needed
  }

  // First-time linear flow
  function startFirstTime() {
    // start with game, then chain on completion
    showPage('game');
    questionIndex = 0;
    loadNextQuestion();
    firstTimeSequence = ['elevator','about','why','events'];
    sequencePointer = 0;
    // when game done, advance through sequence
  }

  // Questions logic
  const questionPool = [
    "Co jest najtrudniejsze w twojej samotności?",
    "Dlaczego potrzebujesz przyjaciół?",
    "Jaką aktywność chciałbyś robić z innymi?",
    "Czego ostatnio szukasz w relacjach?",
    "Kiedy czułeś się naprawdę zrozumiany?",
    "Co powstrzymuje cię przed poznawaniem ludzi?",
    "Jaka rozmowa zmieniła twoje spojrzenie na siebie?",
    "Kogo chciałbyś zaprosić do rozmowy?",
    "Co byś dał innym w relacji?",
    "Jakie małe działanie mogłoby cię przybliżyć do kogoś nowego?"
  ];
  let shuffled = [];
  let questionIndex = 0;
  let firstTimeSequence = [];
  let sequencePointer = 0;

  function shuffleArray(a) {
    return a
      .map(v => ({v, r: Math.random()}))
      .sort((a,b)=>a.r - b.r)
      .map(o => o.v);
  }

  function loadNextQuestion() {
    if (shuffled.length === 0) shuffled = shuffleArray(questionPool);
    if (questionIndex >= 5) { // after 5 questions, proceed in first-time flow if applicable
      if (firstTimeSequence[sequencePointer]) {
        showPage(firstTimeSequence[sequencePointer++]);
      }
      return;
    }
    document.getElementById('current-question').textContent = shuffled[questionIndex];
    questionIndex++;
  }

  document.getElementById('next-question-btn').addEventListener('click', loadNextQuestion);

  function skipToEvents() {
    showPage('events');
  }

  // Email form submit
  document.getElementById('emailForm').addEventListener('submit', e => {
    e.preventDefault();
    // here: send to backend or store
    document.getElementById('emailForm').style.display = 'none';
    document.getElementById('email-thanks').style.display = 'block';
  });

  // Signup flow
  function openSignup(eventName) {
    document.getElementById('signup-title').textContent = `Zapisz się na: ${eventName}`;
    showPage('signup');
  }
  document.getElementById('signupForm').addEventListener('submit', e => {
    e.preventDefault();
    document.getElementById('signupForm').style.display = 'none';
    document.getElementById('signup-thanks').style.display = 'block';
  });

  // Initialize to game
  showPage('game');
  shuffled = shuffleArray(questionPool);
  loadNextQuestion();
</script>
